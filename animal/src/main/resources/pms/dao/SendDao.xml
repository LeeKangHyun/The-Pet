<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="pms.dao.SendDao">
	
	<resultMap type="send" id="sendMap">
		<id 	column="MSG_NUM" 		property="msgNo"/>
		<result column="MEM_NUM" 		property="sendMno"/>    
		<result column="MEM_NUM2" 		property="recvMno"/>
		<result column="MSG_CONTENT" 	property="msgContent"/>
		<result column="CHECKED" 		property="msgChecked"/>
		<result column="SEND_DATE" 		property="msgCreateDate"/>
	</resultMap>
	
	<select id="sendList" resultMap="sendMap" parameterType="map">
		select 
			MSG_NUM, 
			MEM_NUM,
			MEM_NUM2,
			MSG_CONTENT,
			CHECKED,
			SEND_DATE
		from sendbox
		where MEM_NUM=#{sendMno}
		order by SEND_DATE desc
		limit #{startIndex}, 15
	</select>
	
	<select id="selectOne" resultMap="sendMap" parameterType="int">
		select 
			MSG_NUM, 
			MEM_NUM,
			MEM_NUM2,
			MSG_CONTENT,
			CHECKED,
			SEND_DATE
		from sendbox
		where MSG_NUM=#{msgNo}
	</select>
	
	<select id="sendCount" resultMap="sendMap" parameterType="int">
		select count(*) as count
		from sendbox
		where MEM_NUM=#{sendMno}
	</select>
	
	<insert id="insert" parameterType="send">
		insert into sendbox(MEM_NUM,MEM_NUM2,MSG_CONTENT,CHECKED,SEND_DATE)
		values(#{sendMno},#{recvMno},#{msgContent},1,now())
	</insert>
	
	<delete id="delete" parameterType="int">
		delete from sendbox where MSG_NUM=#{msgNo}
	</delete>
	
	<delete id="deleteAll" parameterType="int">
		delete from sendbox where MEM_NUM=#{sendMno}
	</delete>
    
</mapper>






