<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="pms.dao.DiaryDao">

<resultMap type="diary" id="diaryMap">
  <id column="SCH_NUM" property="dno"/>
  <result column="PET_NUM" property="pno"/>
  <result column="START_DATE" property="startDate"/>
  <result column="END_DATE" property="endDate"/>
  <result column="SCH_CRE" property="createDate"/>
  <result column="SCH_CONTENT" property="content"/>
  <result column="SCH_TITLE" property="title"/>
  <result column="CATE_CODE" property="cateCode"/>
  <result column="NOTI_HIDE" property="dhide"/>
  <result column="NOTI_VIEWS" property="view"/>
  <result column="NOTI_LIKES" property="like"/>
  <result column="TAG_COLOR" property="tagColor"/>
  <association property="pet" javaType="Pet">
    <id column="PET_NUM" property="pno"/>
    <result column="PET_NAME" property="pName"/>
    <result column="MEM_NUM" property="mno" />
    <result column="PET_TYPE" property="pType"/>
    <result column="PET_IMG" property="pImg"/>
    <result column="TAG_COLOR" property="tagColor"/>
    <result column="INJECTION" property="injection"/>
    <result column="MEDICINE" property="medicine"/>
  </association>
</resultMap>

  <select id="eventList" resultMap="diaryMap">
    select
  		SCH_NUM,
  		START_DATE,
  		END_DATE,
  		SCH_TITLE,
  		SCH_CONTENT,
  		NOTI_HIDE,
  		tag_Color
  	from schedule
  </select>

<select id="petList" resultMap="diaryMap">
  	select
  		p1.pet_num as PET_NUM,
  		p1.pet_name as PET_NAME,
  		p1.pet_type as PET_TYPE,
  		p1.pet_img as PET_IMG,
  		p1.tag_color as TAG_COLOR,
  		p1.injection as INJECTION,
  		p1.medicine as MEDICINE
  	from member m1 left outer join pet p1 on m1.mem_num = p1.mem_num
  	where p1.mem_num=1
  </select>
 

  <insert id="insertText" parameterType="diary">
    insert into schedule(pno,startDate,endDate,createDate,content,title,cateCode,dhide)
    values(#{pno},#{startDate},#{endDate},now(),#{content},#{title},#{dhide})
  </insert>

  <delete id="delete" parameterType="int">
    delete from schedule
  	where dno=#{dno}
  </delete>

  <update id="update" parameterType="diary">
    update schedule set
      startDate=#{startDate},
      endDate=#{endDate},
      title=#{title},
  	  content=#{content}
  	  dhide=#{dhide}
    where dno=#{dno}
  </update>


</mapper>
